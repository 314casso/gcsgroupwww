<HTML>
<TITLE>Изменение свойств изображения</TITLE>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<STYLE>
BODY, TD, INPUT, select {font-size: 9pt;font-family:Arial} 
</STYLE>
</HEAD>
<body bgcolor="#D6D3CE">
<script language=javascript>
var myPage = window.opener;

window.onload = setValues;

var imageWidth = myPage.selectedIMG.width;
var imageHeight = myPage.selectedIMG.height;
var imageAlign = myPage.selectedIMG.align;
var imageBorder = myPage.selectedIMG.border;
var imageAltTag = myPage.selectedIMG.alt;
var imageSrc = myPage.selectedIMG.src;
var imageHspace = myPage.selectedIMG.hspace;
var imageVspace = myPage.selectedIMG.vspace;

function setValues() {

	imageForm.image_width.value = imageWidth;
	imageForm.image_height.value = imageHeight;

	if (imageBorder == "") {
		imageBorder = "0"
	}

	imageForm.border.value = imageBorder;
	imageForm.alt_tag.value = imageAltTag;
	imageForm.src_tag.value = imageSrc;
	imageForm.hspace.value = imageHspace;
	imageForm.vspace.value = imageVspace;
	this.focus();
}

function doModify() {

	var error = 0;
	if (isNaN(imageForm.image_width.value) || imageForm.image_width.value < 0) {
		alert("Шириной изображения должна быть корректная, положительная цифра")
		error = 1
		imageForm.image_width.select()
		imageForm.image_width.focus()
	} else if (isNaN(imageForm.image_height.value) || imageForm.image_height.value < 0) {
		alert("Высотой изображения должна быть корректная, положительная цифра")
		error = 1
		imageForm.image_height.select()
		imageForm.image_height.focus()
	} else if (isNaN(imageForm.border.value) || imageForm.border.value < 0 || imageForm.border.value == "") {
		alert("Рамкой изображения должна быть корректная, положительная цифра")
		error = 1
		imageForm.border.select()
		imageForm.border.focus()
	} else if (isNaN(imageForm.hspace.value) || imageForm.hspace.value < 0) {
		alert("Горизонтальным отступом изображения должна быть корректная, положительная цифра")
		error = 1
		imageForm.hspace.select()
		imageForm.hspace.focus()
	} else if (isNaN(imageForm.vspace.value) || imageForm.vspace.value < 0) {
		alert("Вертикальным отступом изображения должна быть корректная, положительная цифра")
		error = 1
		imageForm.vspace.select()
		imageForm.vspace.focus()
	}

	if (error != 1) {
        	myPage.selectedIMG.width = imageForm.image_width.value
			myPage.selectedIMG.height = imageForm.image_height.value
			myPage.selectedIMG.alt = imageForm.alt_tag.value
			myPage.selectedIMG.border = imageForm.border.value
    
	if (imageForm.hspace.value != "") {
			myPage.selectedIMG.hspace = imageForm.hspace.value
	} else {
			myPage.selectedIMG.removeAttribute('hspace',0)
	}

	if (imageForm.vspace.value != "") {
			myPage.selectedIMG.vspace = imageForm.vspace.value
	} else {
			myPage.selectedIMG.removeAttribute('vspace',0)
	}
        myPage.selectedIMG.src=imageForm.src_tag.value
	if (imageForm.align[imageForm.align.selectedIndex].value != "None") {
       		myPage.selectedIMG.align = imageForm.align[imageForm.align.selectedIndex].value
	} else {
       		myPage.selectedIMG.removeAttribute('align',0)
	}
        
    window.close()
	}
}

function printAlign() {
	if ((imageAlign != undefined) && (imageAlign != "")) {
		document.write('<option value="'+imageAlign+'" selected>' + imageAlign)
		document.write('<option>нет')
	} else {
		document.write('<option selected>нет')
	}
}

</script>

<form name=imageForm>

<table border="0" cellspacing="0" cellpadding="2">
<tr>
<td colspan=3>

<table style="border:1px solid white" border="0" cellspacing="0" cellpadding="2" width="100%">
<tr>
<td style="background-color:#fdfdfd;border:1px solid white" colspan=3>Свойства изображения</td>
</tr>
<tr>
<td>Адрес:</td>
<td><input type="text" name="src_tag" size="45"></td>
<td><input type="button" style="width:60px" name="modifyImage" value="Ok" onClick="javascript:doModify();"></td>
</tr>
<tr>
<td>Текст:</td>
<td><input type="text" name="alt_tag" size="45"></td>
<td><input type="button" style="width:60px" name="Submit" value="Отмена" onClick="javascript:window.close()"></td>
</tr>
</table>


</td></tr>
<tr>
<td>

<table style="border:1px solid white" border="0" cellspacing="0" cellpadding="2" width="100">
<tr>
<td style="background-color:#fdfdfd;border:1px solid white" colspan=2>Изображение</td>
</tr>
<tr>
<td>Ширина:</td>
<td><input type="text" name="image_width" size="3" maxlength="4"></td>
</tr>
<td>Высота:</td>
<td><input type="text" name="image_height" size="3" maxlength="4"></td>
</tr>
</table>

</td>
<td>
<table style="border:1px solid white" border="0" cellspacing="0" cellpadding="2" width="150">
<tr>
<td style="background-color:#fdfdfd;border:1px solid white" colspan=2>Отображение</td>
</tr>
<tr>
<td>Позиция:</td>
<td><SELECT class=text70 name=align>
<script>printAlign()</script>
<option value="Left">слева
<option value="Right">справа
<option value="TextTop">над текстом
<option value="Baseline">по основанию
<option value="Top">сверху
<option value="Middle">посередине
<option value="Bottom">снизу

<option value="ABSMiddle">абс. середина
<option value="ABSBottom">абс. снизу
</select>
</td>
</tr>
<tr>
<td>Рамка:</td>
<td><input type="text" name="border" size="3" maxlength="3"></td>
</tr>
</table>
</td>
<td>

<table style="border:1px solid white" border="0" cellspacing="0" cellpadding="2" width="120">
<tr>
<td style="background-color:#fdfdfd;border:1px solid white" colspan=2>Отступы</td>
</tr>
<tr>
<td>По бокам:</td>
<td><input type="text" name="hspace" size="3" maxlength="3"></td>
</tr>
<td>Верх/низ:</td>
<td><input type="text" name="vspace" size="3" maxlength="3"></td>
</tr>
</table>

</td></tr>
</table>

</form>
</body>
</html>