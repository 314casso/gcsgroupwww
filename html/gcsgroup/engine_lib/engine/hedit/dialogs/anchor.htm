<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>Якорь (*ссылка в пределах страницы)</title>
<STYLE>
BODY, TD, INPUT {font-size: 9pt;font-family:Arial} 
</STYLE>
</HEAD>
<body bgcolor="#D6D3CE">
<script language=javascript>
var myPlace = window.opener;

window.onerror = stopError

	function stopError() {
		return true;
	}

	function getAnchor() {

		if (myPlace.thePlace.selection.type == "Control") {
			var oControlRange = myPlace.thePlace.selection.createRange();
			if (oControlRange(0).tagName.toUpperCase() == "IMG") {
				var oSel = oControlRange(0).parentNode;
			}
		} else {
			oSel = myPlace.thePlace.selection.createRange().parentElement();
		}

		if (oSel.tagName.toUpperCase() == "A")
		{
			document.linkForm.anchorName.value = oSel.name
		} 
	}

	function InsertAnchor() {
		var anchorName = document.linkForm.anchorName.value

		if (anchorName != "")
		{
			var oNewLink = myPlace.thePlace.createElement("<A>");
			oNewSelection = myPlace.thePlace.selection.createRange();

			if (myPlace.thePlace.selection.type == "Control")
			{
				selectedImage = myPlace.thePlace.selection.createRange()(0);
				selectedImage.width = selectedImage.width
				selectedImage.height = selectedImage.height
			}

			oNewSelection.execCommand("CreateLink",false,"");

			if (myPlace.thePlace.selection.type == "Control")
			{
				oLink = oNewSelection(0).parentNode;
			} else
				oLink = oNewSelection.parentElement()

			oLink.removeAttribute("href");

			if (anchorName != "")
			{
				oLink.name = anchorName;
			} else
				oLink.removeAttribute("name")

			self.close();
		} else {
			alert("Название якоря не может быть пустым")
			document.linkForm.anchorName.focus()
		}
	}


	function RemoveAnchor() {
		if (myPlace.thePlace.selection.type == "Control")
		{
			selectedImage = myPlace.thePlace.selection.createRange()(0);
			selectedImage.width = selectedImage.width
			selectedImage.height = selectedImage.height
		}

		myPlace.thePlace.execCommand("Unlink");
		self.close();
	}

</script>
<FORM METHOD=POST name=linkForm>


<table style="border:1px solid white" border="0" cellspacing="0" cellpadding="2" width="100%" align="center">
<tr>
<td>Название:</td>
<td><input type="text" name="anchorName" value="" size=37></td>
</tr>
<tr>
<td colspan=2>
<input type="button" name="insertAnchor" value="Добавить якорь" onClick="javascript:InsertAnchor();">
<input type="button" name="removeAnchor" value="Удалить" onClick="javascript:RemoveAnchor();">
<input type=button name="Cancel" value="Отмена" onClick="javascript:window.close()">

</td>
</tr>
</form>
<script>getAnchor()</script>
</table>
</body>
</html>